## Description:
Simple python script that can help to extract bat-crypter loader used by several prevalent malware like AsyncRAT that are commonly downloaded by malicious file attached to
spear phishing .one attachment

## Technique
The batch has a series of obfuscation and encryption to hide the actual payload it will be executed.
1. the used of consecutive environment variable that contains chunck of string it will concatenate to generate the powershell decryptor
2. the powershell will initialized the base 64 encoded big comment string in the .bat file as well the aes 256 key and IV to execute the payload.
3. decompress the decrypted data chunk with gunzip

## idea behind this script
base on my sample gathering and analysis, each .bat crypter can own different aes key and aes IV which can be exhausted to decrypt bunch of sample 1 by 1 manually.
This script will do the following:
1. instead running the actual obfuscated bat script it will generate a temp.bat that contain debug print on the possible obfuscated powershell.
2. once we grab the original script we will parse the the aes key, aes IV and the encoded and ecrypted payload data.
3. decrypt and dump the gzip and the binary file payload.


## example execution and output


![asyncrat-extractor](https://user-images.githubusercontent.com/26181693/214107306-2c260c27-c3ff-4e79-8938-6bfc7d6ded63.png)


### hashes available in malware bazaar (kudos to malware bazaar and researcher sharing the samples)
2421e2d7ed44911ce2d2f2d288a33c8650a2e5847d81b02911e3da31c292d03a.bat-1
37563d85d00f66f27dfbdea1978227cccb739702aca826a9bdf671fd26d6b6a4.bat-1
3d5e76babb87991d4abec7c048b34074ccc7c680f49639e0c55e5be0ee6df33d.bat-1
8ee8a12754f344d0a1249f2de4d11044ebba8ba354df769d8d5019a639bb69c6.bat-1
92dabfde91df07a3b2105e5972fbd2f5acf64b53465b60165a53e0795c1be8ba.bat-1
bce00edede51b68cbf740e51b9f184bfd003d6ccb682cdcc661ecaa82dd67e42.bat-1
c4952d905a0fb0466d45a58606635f0a2ac3b7c5cbb7e517118a9b695e3012e2.bat-1
f1a126ea617a045454badfb230b3bc86ee5c1ad5698c1285472f71fc8497cbfc.bat-1
