__author__ = "tccontre18 - Br3akp0int"

"""
malware    : AgentTesla Loader
analyzed by : tccontre18 - Br3akp0int
description: a short python script to deobfuscate the function loader of the
             Agent Tesla
"""

import os


def main():
    function_loader_obfus='011K110,01110101,01101110,011K011,011101K,01101K1,01101111,01101110,K1KK0,011101K,01K1101,01KK11,011K110,01101011,0101K11,01K01K,K1KK0,01111011,KK1101,KK1010,KK1101,KK1010,KK1K1,01011011,01KK11,01101101,011K1K,011011K,011K101,011101K,01KK10,01101K1,01101110,011K1K,01101K1,01101110,011K111,K101K0,K101K1,01011101,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,0101KK,011KK1,0111K10,011KK1,01101101,K1KK0,K101K0,01011011,011K010,01111K1,011101K,011K101,01011011,01011101,01011101,K1KK0,K1K1K,011K010,01111K1,011101K,011K101,01KK01,0111K10,0111K10,011KK1,01111K1,K101K1,KK1101,KK1010,K1KK0,KK1101,KK1010,KK1K1,0101KK,0111K10,01101111,011K011,011K101,0111K11,0111K11,K1KK0,01111011,KK1101,KK1010,KK1K1,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,011K111,01101011,011K1K,011K110,K111101,K101K0,K1K111,K101K0,01011011,01K1K1,01K1111,K101110,01KK11,01101111,01101101,0111KK,0111K10,011K101,0111K11,0111K11,01101K1,01101111,01101110,K101110,01KK11,01101111,01101101,0111KK,0111K10,011K101,0111K11,0111K11,01101K1,01101111,01101110,01K1101,01101111,011K1K,011K101,01011101,K111010,K111010,01K01K,011K101,011K011,01101111,01101101,0111KK,0111K10,011K101,0111K11,0111K11,K101K1,K1K111,K101K1,011111K,01K1K1,011KK0,01K0101,011KK0,01011K0,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,01110110,01110111,011011K,01K1111,01010110,01010101,01101101,01011K1,K1KK0,K111101,K1KK0,K101K0,K1K111,01K1110,011K101,01110111,K101101,K1K111,K1KK0,K101011,K1KK0,K1K111,01K1111,011K010,01101010,011K101,011K011,K1K111,K1KK0,K101011,K1KK0,K1K111,011101K,K1KK0,0101K11,01111K1,0111K11,011101K,011K101,01101101,K1K111,K1KK0,K101011,K1KK0,K1K111,K101110,01K1K1,01K1111,K101110,01K1101,011K101,01101101,K1K111,K1KK0,K101011,K1KK0,K1K111,01101111,0111K10,01111K1,0101K11,011101K,0111K10,011K101,011KK1,01101101,K101K0,K1KK0,K1011K,K1KK0,K1K1K,011K010,01111K1,K1K111,K1KK0,K101011,K1KK0,K1K111,011101K,011K101,01KK01,0111K10,0111K10,011KK1,01111K1,K1KK0,K101K1,K1K111,K101K1,011111K,01K1K1,011KK0,01K0101,011KK0,01011K0,KK1101,KK1010,KK1K1,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,0111KK,01011K0,01010111,011KK1,011K010,011K010,01KK10,010101K,K1KK0,K111101,K1KK0,K101K0,K1K111,01K1110,011K101,K1K111,K1KK0,K101011,K1KK0,K1K111,01110111,K101101,01K1111,011K010,01101010,K1K111,K1KK0,K101011,K1KK0,K1K111,011K101,011K011,011101K,K1KK0,0101K11,01111K1,0111K11,011101K,K1K111,K1KK0,K101011,K1KK0,K1K111,011K101,01101101,K101110,01K1K1,01K1111,K101110,01K1101,011K101,01101101,K1K111,K1KK0,K101011,K1KK0,K1K111,01101111,0111K10,01111K1,0101K11,K1K111,K1KK0,K101011,K1KK0,K1K111,011101K,0111K10,011K101,011KK1,01101101,K1K111,K101K1,011111K,01K1K1,011KK0,01K0101,011KK0,01011K0,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,011011K,011K110,01K1011,01K01K,01K0101,011011K,01K1010,K1KK0,K111101,K1KK0,01K1110,011K101,01110111,K101101,01K1111,011K010,01101010,011K101,011K011,011101K,K1KK0,0101K11,01111K1,0111K11,011101K,011K101,01101101,K101110,01K1K1,01K1111,K101110,01KK11,01101111,01101101,0111KK,0111K10,011K101,0111K11,0111K11,01101K1,01101111,01101110,K101110,01K0111,01111010,01101K1,0111KK,0101K11,011101K,0111K10,011K101,011KK1,01101101,K1KK0,K1K1K,01110110,01110111,011011K,01K1111,01010110,01010101,01101101,01011K1,K1011K,K1KK0,K1K1K,011K111,01101011,011K1K,011K110,KK1101,KK1010,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,01010101,01K11K,01111K0,01K1K0,011K101,011K011,01K11K,0111KK,01K11K,K1KK0,K111101,K1KK0,K101K0,K1K111,01K1110,011K101,01110111,K1K111,K1KK0,K101011,K1KK0,K1K111,K101101,01K1111,011K010,01101010,K1K111,K1KK0,K101011,K1KK0,K1K111,011K101,011K011,011101K,K1KK0,011K010,01111K1,K1K111,K1KK0,K101011,K1KK0,K1K111,011101K,011K101,01011011,01011101,K101K0,K11K01,K11KK,K1K111,K1KK0,K101011,K1KK0,K1K111,K11K10,K1101K,K101K1,K1K111,K101K1,011111K,01K1K1,011KK0,01K0101,011KK0,01011K0,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,01110111,01101K0,01101K1,011011K,011K101,K101K0,K1K1K,011101K,0111K10,01110101,011K101,K101K1,01111011,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,01101K1,01K11K,0101K01,01KK11,K1KK0,K111101,K1KK0,K1K1K,011011K,011K110,01K1011,01K01K,01K0101,011011K,01K1010,K101110,0101K10,011K101,011KK1,011K1K,K101K0,K1K1K,01010101,01K11K,01111K0,01K1K0,011K101,011K011,01K11K,0111KK,01K11K,K1011K,K1KK0,K11KK,K1011K,K1KK0,K11K01,K11KK,K11K10,K1101K,K101K1,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,01101K1,011K110,K1KK0,K101K0,K1K1K,01101K1,01K11K,0101K01,01KK11,K1KK0,K101101,011011K,011K101,K1KK0,K11KK,K101K1,01111011,011K010,0111K10,011K101,011KK1,01101011,01111101,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1K1K,0111KK,01011K0,01010111,011KK1,011K010,011K010,01KK10,010101K,K101110,01010111,0111K10,01101K1,011101K,011K101,K101K0,K1K1K,01010101,01K11K,01111K0,01K1K0,011K101,011K011,01K11K,0111KK,01K11K,K1011K,K1KK0,K11KK,K1011K,K1KK0,K1K1K,01101K1,01K11K,0101K01,01KK11,K101K1,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,01111101,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,KK1101,KK1010,KK1K1,KK1K1,01011011,011K010,01111K1,011101K,011K101,01011011,01011101,01011101,K1KK0,K1K1K,011K010,01101111,01110101,011101K,K1KK0,K111101,K1KK0,K1K1K,0111KK,01011K0,01010111,011KK1,011K010,011K010,01KK10,010101K,K101110,010101K,01101111,01KK01,0111K10,0111K10,011KK1,01111K1,K101K0,K101K1,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,K1KK0,01010111,0111K10,01101K1,011101K,011K101,K101101,01K1111,01110101,011101K,0111KK,01110101,011101K,K1KK0,K1K1K,011K010,01101111,01110101,011101K,KK1101,KK1010,K1KK0,K1KK0,K1KK0,K1KK0,01111101,KK1101,KK1010,01111101'.replace('K','00')

    func_loader_list = function_loader_obfus.split(",")
    
    func_code = ''.join([chr(int(x, 2)) for x in func_loader_list])

    print(func_code)

    return



if __name__ == "__main__":
    main()

