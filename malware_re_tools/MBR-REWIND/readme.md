# MBR-REWIND (READ-WRITE-RESTORE MBR CODE POC Tool) 
--------------------------------------------------------

<img src="screenshots/banner.png"> </img>

 ## WARNING: 
 USE AT YOUR OWN RISK!!!!. DONT USE OR TEST THIS TOOL IN PRODUCTION OR NON-TEST LAB MACHINE
 THIS TOOL WAS DESIGNED FOR RESEARCH, TESTING AND EDUCATIONAL PURPOSES.  IF YOU DOWNLOAD OR
 USE THIS TOOL/CODE, YOU ARE COMPLETELY RESPONSIBLE FOR ANY RESULTING LOSS OR DAMAGES.
 THE AUTHOR HAS NO RESPONSIBILITIES FOR ERRORS, DAMAGES, LOSS, INACCURACY OR OMMISION IN
 THE CONTENT UPON USING IT.

## DESCRIPTION:
Analyzing destructive malware that overwrite, encrypt or wipe MBR code might be time consuming in terms of testing and generating events, 
because once the machine is rebooted, you need either to revert your test lab or restore the Original MBR code if you save it.
This POC tool is designed for that research, testing and detection purposes. The following features of this are stated below:

1. **backup** the current MBR code for restoration purposes
2. **Read** the current MBR code in Boot Sector or PhysicalDriveO 
3. **Overwrite** The MBR code with customized MBR code that was saved in 'mal_mbr.bin' file
4. **restore** the original MBR code
5. **simulate** known attack made by adversaries or threat actor (e.g whispergate, notpetya,olympic destroyer and etc.) to destroy and  MBR code

## FEATURES:
--------------------------------------------------------
### RUN_TEST-MBR: 
```
MBR-REWIND -rt
```
run read, overwrite and restore feature at once.

### BACKUP-MBR: 
```
MBR-REWIND -b
```

Before you can execute all other feature, the tool requires you to generate MBR code back-up that will be save in 'backup_mbr_code.bin' in current directory for restoration purposes.

![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/1.gif)


### READ-MBR:
```
MBR-REWIND -r
```

This feature allow you to read the current MBR code in \\.\PhysicalDrive0 device then display its hexdump and save it to a file '<sha1>_current_mbr_code.bin' in current working directory.

### OVERWRITE-MBR:
```
MBR-REWIND -o
```
overwrite the MBR code with customized MBR code saved in file 'mal_mbr.bin' in current directory.
 
![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/3.gif) 
 
 
### RESTORE-MBR:
```
MBR-REWIND -re
```
restore MBR code from the 'backup_mbr_code.bin' file generated upon executing this tool

### SIMULATION FEATURES SCENARIO:
```
MBR-REWIND -su
```
Overwrite MBR with unintialized allocated buffer.

![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/6.gif) 

```
MBR-REWIND -sz
```
wiping MBR with zeroed allocated buffer.

![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/7.gif) 
 
 
```
MBR-REWIND -se
```
xor-encrypt the original MBR code. (NotPetya Ransomware)

![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/5.gif) 


### INFECT AND RESTORE (e.g WHISPERGATE)

I run whispergate malware to overwrite the MBR code with its ransom notes and restore the original MBR code.

![myfile](https://github.com/tccontre/KnowledgeBase/blob/main/malware_re_tools/MBR-REWIND/screenshots/2.gif) 
 

